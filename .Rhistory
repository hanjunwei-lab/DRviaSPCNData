devtools::document()
devtools::load_all(".")
library(DRviaSPCNData)
remove.packages("Disease2Drug")
remove.packages("Disease2DrugData")
library(devtools)
install_github('hanjunwei-lab/DRviaSPCNData')
library(DRviaSPCNData)
Getlist('DrugPvalueMatrix')
load("E:/1work/DRviaSPCN/DRviaSPCNData/data/envData_sp.rda")
View(envData_sp)
library(DRviaSPCNData)
a<-Getlist("DrugPscoreMatrix")
View(a)
b<-Getlist("DrugPvalueMatrix")
View(b)
save(b,file = "b.rdata")
View(a)
View(a)
a<-Getlist("DrugPscoreMatrix")
library(DRviaSPCNData)
a<-Getlist("DrugPscoreMatrix")
b<-Getlist("DrugPvalueMatrix")
View(b)
load("E:/1work/xinketi/Drug_ESscore_matrix.rdata")
load("E:/1work/xinketi/Drug_Pscore_matrix3_1.rdata")
load("E:/1work/DRviaSPCN/DRviaSPCNData/data/envData_sp.rda")
View(envData_sp)
envData_sp$DrugPscoreMatrix<-Drug_Pscore_matrix3_1
envData_sp$DrugEScoreMatrix<-Drug_ESscore_matrix
View(envData_sp)
load("E:/1work/xinketi/drug2subpathway3742.rdata")
View(drug2subpathway)
View(drug2subpathway[["(+)-chelidonine_HL60_6_1.08e-05"]])
load("E:/1work/xinketi/drug3101_3742.rdata")
View(drug3101_3742)
View(drug3101_3742[[1]])
load("E:/1work/xinketi/alldrug2subpathway3742.RData")
View(alldrug2subpathway3742)
View(alldrug2subpathway3742[[1]])
View(alldrug2subpathway3742)
View(drug2subpathway)
names(alldrug2subpathway3742)<-names(drug2subpathway)
save(alldrug2subpathway3742,file = 'alldrug2subpathway_p_3742.RData')
View(alldrug2subpathway3742)
View(drug2subpathway)
View(drug2subpathway[["(+)-chelidonine_HL60_6_1.08e-05"]])
View(alldrug2subpathway3742[["(+)-chelidonine_HL60_6_1.08e-05"]])
alldrug2subpathway3742<-alldrug2subpathway3742[match(colnames(Drug_Pscore_matrix3_1),names(alldrug2subpathway3742))]
View(alldrug2subpathway3742)
save(alldrug2subpathway3742,file = 'alldrug2subpathway_p_3724.RData')
View(alldrug2subpathway3742)
View(alldrug2subpathway3742[["(+)-chelidonine_HL60_6_1.08e-05"]])
View(Drug_Pscore_matrix3_1)
View(Drug_ESscore_matrix)
sp<-rownames(Drug_ESscore_matrix)
alldrug2subpathway3742[[1]]
View(alldrug2subpathway3742[["(+)-chelidonine_HL60_6_1.08e-05"]])
DrugPvalueMatrix<-matrix(NA,689,3724)
DrugPvalueMatrix<-matrix(NA,689,3724)
for (i in 1:3724) {
d2sp<-alldrug2subpathway3742[[i]]
d2sp<-d2sp[match(sp,rownames(d2sp)),]
pv<-d2sp[,6]
DrugPvalueMatrix[,i]<-pv
}
View(DrugPvalueMatrix)
DrugPvalueMatrix<-matrix(NA,689,3724)
i=1
d2sp<-alldrug2subpathway3742[[i]]
d2sp<-d2sp[match(sp,rownames(d2sp)),]
pv<-d2sp[,6]
View(d2sp)
d2sp<-alldrug2subpathway3742[[i]]
d2sp<-d2sp[match(sp,d2sp[,1]),]
pv<-d2sp[,6]
View(d2sp)
DrugPvalueMatrix<-matrix(NA,689,3724)
for (i in 1:3724) {
d2sp<-alldrug2subpathway3742[[i]]
d2sp<-d2sp[match(sp,d2sp[,1]),]
pv<-d2sp[,6]
DrugPvalueMatrix[,i]<-pv
}
View(DrugPvalueMatrix)
View(DrugPvalueMatrix)
View(b)
colnames(DrugPvalueMatrix)<-colnames(Drug_ESscore_matrix)
rownames(DrugPvalueMatrix)<-sp
View(DrugPvalueMatrix)
View(envData_sp)
envData_sp$DrugPvalueMatrix<-DrugPvalueMatrix
View(envData_sp)
envData_sp$DrugPscoreMatrix<-Drug_Pscore_matrix3_1
envData_sp$DrugEScoreMatrix<-Drug_ESscore_matrix
envData_sp$DrugPvalueMatrix<-DrugPvalueMatrix
View(envData_sp)
View(envData_sp)
usethis::use_data(envData_sp,overwrite = T,compress = "xz")
rm(DrugEScoreMatrix,envir = envData_sp)
View(envData_sp)
envData_sp$DrugEscoreMatrix<-Drug_ESscore_matrix
View(envData_sp)
View(envData_sp)
usethis::use_data(envData_sp,overwrite = T,compress = "xz")
devtool::document()
devtools::document()
devtools::load_all(".")
load("E:/1work/DRviaSPCN/DRviaSPCNData/g.rdata")
load("E:/1work/DRviaSPCN/DRviaSPCNData/s.rdata")
load("E:/1work/DRviaSPCN/DRviaSPCNData/data/envData_sp.rda")
View(envData_sp)
envData_sp$GO_BP<-g
envData_sp$Subpathways<-s
View(envData_sp)
usethis::use_data(envData_sp,overwrite = T,compress = "xz")
devtools::document()
devtools::load_all(".")
library(DRviaSPCNData)
devtools::document()
devtools::load_all(".")
library(DRviaSPCNData)
library(DRviaSPCNData)
data("envData_sp")
force(envData_sp)
View(envData_sp)
View(envData_sp)
View(envData_sp[["GO_BP"]])
View(envData_sp)
devtools::document()
devtools::load_all(".")
devtools::document()
devtools::load_all(".")
devtools::document()
devtools::load_all(".")
remove.packages("DRviaSPCNData")
devtools::install_github("hanjunwei-lab/DRviaSPCNData")
library(DRviaSPCNData)
View(envData_sp)
load("E:/1work/DRviaSPCN/DRviaSPCNData/Drug_central_matrix.rdata")
View(Drug_central_matrix)
Drug_central_matrix<-round(Drug_central_matrix,5)
View(Drug_central_matrix)
Drug_central_matrix<-round(Drug_central_matrix,4)
View(Drug_central_matrix)
load("E:/1work/DRviaSPCN/DRviaSPCNData/Drug_central_matrix.rdata")
Drug_central_matrix<-round(Drug_central_matrix,5)
View(Drug_central_matrix)
DrugCentralMatrix<-Drug_central_matrix
View(envData_sp)
envData_sp$DrugCentralMatrix<-DrugCentralMatrix
View(envData_sp)
usethis::use_data(envData_sp,overwrite = T,compress = "xz")
rm(DrugCentralMatrix,envir = envData_sp)
View(envData_sp)
usethis::use_data(envData_sp,overwrite = T,compress = "xz")
envData_sp$DrugCentralMatrix<-DrugCentralMatrix
View(envData_sp)
View(envData_sp)
usethis::use_data(envData_sp,overwrite = T,compress = "xz")
devtools::document()
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
View(envData_sp)
rm(DrugCentralMatrix,envir = envData_sp)
View(envData_sp)
a<-envData_sp$DrugPscoreMatrix
View(a)
a<-envData_sp$DrugPscoreMatrix
View(a)
b<-envData_sp$DrugEscoreMatrix
View(b)
View(b)
View(Drug_central_matrix)
View(a)
DrugCentralMatrix<-DrugCentralMatrix[,match(colnames(a),colnames(DrugCentralMatrix))]
View(DrugCentralMatrix)
envData_sp$DrugCentralMatrix<-DrugCentralMatrix
View(envData_sp)
envData_sp[["DrugEscoreMatrix"]]
envData_sp[["DrugEscoreMatrix"]][,1]
View(envData_sp)
usethis::use_data(envData_sp,overwrite = T,compress = "xz")
devtools::document()
devtools::load_all(".")
library(DRviaSPCNData)
devtools::document()
devtools::load_all(".")
library(DRviaSPCNData)
devtools::document()
devtools::load_all(".")
library(DRviaSPCNData)
detach("package:DRviaSPCNData", unload = TRUE)
remove.packages("DRviaSPCNData")
devtools::install_github("hanjunwei-lab/DRviaSPCNdata")
library(DRviaSPCNData)
a<-Getlist("DrugCentralMatrix")
View(a)
library(SubtypeDrug)
data(GSE45827expr)
detach("package:SubtypeDrug", unload = TRUE)
library(SubtypeDrugData)
data(GSE45827expr)
View(GSE45827expr)
round(GSE45827expr,5)
GSE45827expr<-round(GSE45827expr,5)
View(GSE45827expr)
data(GSE45827expr)
View(GSE45827expr)
GSE45827expr<-round(GSE45827expr,3)
View(GSE45827expr)
usethis::use_data(GSE45827expr,overwrite = T,compress = "xz")
View(GSE45827expr)
load("E:/1work/DRviaSPCN/DRviaSPCNData/data/envData_sp.rda")
View(envData_sp)
envData_sp[["DrugCentralMatrix"]]
envData_sp[["DrugCentralMatrix"]][,1]
envData_sp[["DrugEscoreMatrix"]][,1]
load("E:/1work/DRviaSPCN/DRviaSPCNData/a65194.rdata")
load("E:/1work/DRviaSPCN/DRviaSPCNData/label65194.rdata")
View(a65194)
a65194<-round(a65194,3)
usethis::use_data(a65194,overwrite = T,compress = "xz")
View(envData_sp)
a<-envData_sp$DrugPscoreMatrix
b<-envData_sp$DrugEscoreMatrix
c<-envData_sp$DrugCentralMatrix
d<-envData_sp$DrugPvalueMatrix
a<-round(a,3)
b<-round(b,3)
c<-round(c,3)
d<-round(d,3)
library(DRviaSPCN)
DE2SubPathresult<-DE2SubPath(inexpData=a65194,Label=label65194,nperm=1000)
View(DE2SubPathresult)
SubPathscore<-getSubpathscore(DE2SubPathresult=DE2SubPathresult,inexpData=a65194,Label=label65194)
View(SubPathscore)
Opdrugresult<-optimaldrugs(SubPathscore=SubPathscore,Drug_Pscore_matrix=a,
nperm=1000,topcut=10,pcut=0.01,weight=FALSE)
View(Opdrugresult)
Disease2SPWheatmap(DE2SubPathresult,exp=a65194,Label=label65194,pcut=0.05,bk=c(-2,2),
cluster.rows=FALSE,cluster.cols=FALSE,show.rownames=TRUE,
show.colnames=FALSE,col=c("navy","firebrick3"),
cell.width=NA,cell.height=NA,scale="row",fontsize=7,
fontsize.row=9,fontsize.col=10)
heatmap.list<-Drug2SPWheatmap(drugname = "doxorubicin",
Drug_Pvalue_matrix=DrugPvalueMatrix,
exp=GEP,Label=label,pcut=0.05,bk=c(-2,2),
cluster.rows=FALSE,cluster.cols=FALSE,show.rownames=TRUE,
show.colnames=FALSE,col=c("navy","firebrick3"),
cell.width=NA,cell.height=NA,scale="row",fontsize=7,
fontsize.row=9,fontsize.col=10)
heatmap.list<-Drug2SPWheatmap(drugname = "doxorubicin",
Drug_Pvalue_matrix=d,
exp=GEP,Label=label,pcut=0.05,bk=c(-2,2),
cluster.rows=FALSE,cluster.cols=FALSE,show.rownames=TRUE,
show.colnames=FALSE,col=c("navy","firebrick3"),
cell.width=NA,cell.height=NA,scale="row",fontsize=7,
fontsize.row=9,fontsize.col=10)
heatmap.list<-Drug2SPWheatmap(drugname = "doxorubicin",
Drug_Pvalue_matrix=d,
exp=a65194,Label=label65194,pcut=0.05,bk=c(-2,2),
cluster.rows=FALSE,cluster.cols=FALSE,show.rownames=TRUE,
show.colnames=FALSE,col=c("navy","firebrick3"),
cell.width=NA,cell.height=NA,scale="row",fontsize=7,
fontsize.row=9,fontsize.col=10)
View(heatmap.list)
heatmap.list[["doxorubicin_MCF7_6_6.8e-06"]]
heatmap.list[["doxorubicin_MCF7_6_6.8e-06"]]
View(a)
View(b)
envData_sp$DrugPscoreMatrix<-a
envData_sp$DrugEscoreMatrix<-b
envData_sp$DrugCentralMatrix<-c
envData_sp$DrugPvalueMatrix<-d
View(envData_sp)
Disease2SPWheatmap(DE2SubPathresult,exp=a65194,Label=label65194,pcut=0.05,bk=c(-2,2),
cluster.rows=FALSE,cluster.cols=FALSE,show.rownames=TRUE,
show.colnames=FALSE,col=c("navy","firebrick3"),
cell.width=NA,cell.height=NA,scale="row",fontsize=7,
fontsize.row=9,fontsize.col=10)
devtools::document()
devtools::document()
rm(DrugPscoreMatrix,envir =envData_sp )
View(envData_sp)
View(a)
envData_sp$DrugSPESCMatrix<-a
rm(DrugEscoreMatrix,envir =envData_sp )
envData_sp$DrugSPESMatrix<-b
rm(DrugCentralMatrix,envir =envData_sp )
envData_sp$DrugSPCentralMatrix<-c
rm(DrugPvalueMatrix,envir =envData_sp )
View(d)
envData_sp$DrugSPPvalueMatrix<-d
View(envData_sp)
View(a65194)
envData_sp$GEP<-a65194
envData_sp$label<-label65194
View(envData_sp)
usethis::use_data(envData_sp,overwrite = T,compress = "xz")
devtools::document()
devtools::load_all(".")
library(DRviaSPCNData)
load("E:/1work/DRviaSPCN/DRviaSPCNData/brcadrug.rdata")
library(pROC)
View(Opdrugresult)
Opdrugresult $type<-rep(0,length(Opdrugresult [,1]))
Opdrugresult [which(Opdrugresult [,1]%in%brcadrug[,4]),'type']<-1
Opdrugresult [which(Opdrugresult [,'type']!='1'),'type']<-0
Opdrugresult <-Opdrugresult [order(Opdrugresult [,2]),]
which(Opdrugresult[,5]==1)
mael2 <- glm(Opdrugresult [,5]~Opdrugresult[,2], data=Opdrugresult , family='binomial')
pre2 <- predict(mael2,type='response')
# install.packages("pROC")
maelroc <- roc(Opdrugresult[,5],pre2)
plot(maelroc, print.auc=TRUE, auc.polygon=TRUE, grid=c(0.1, 0.2),
grid.col=c("green", "red"), mahxd.auc.polygon=TRUE,
auc.polygon.col="skyblue", print.thres=TRUE, main="CTSD")
rm(GEP,envir =envData_sp )
envData_sp$GSE65194expr<-a65194
View(envData_sp)
usethis::use_data(envData_sp,overwrite = T,compress = "xz")
devtools::document()
devtools::load_all(".")
remove.packages("DRviaSPCNData")
devtools::install_github('hanjunwei-lab/DRviaSPCNData')
load("E:/1work/DRviaSPCN/DRviaSPCNData/data/envData_sp.rda")
View(envData_sp)
devtools::document()
devtools::load_all(".")
load("E:/DRviaSPCN/DRviaSPCNData/data/envData_sp.rda")
View(envData_sp)
load("D:/1work/rpackages/DRviaSPCN/DRviaSPCNData/data/envData_sp.rda")
View(envData_sp)
load("D:/1work/rpackages/DRviaSPCN/DRviaSPCNData/sdfSET.rdata")
envData_sp$sdfSET<-sdfSET
usethis::use_data(envData_sp,overwrite = TRUE,compress = "xz")
devtools::load_all(".")
library(DRviaSPCNData)
a<-GetData("sdfSET")
devtools::document()
devtools::load_all(".")
library(DRviaSPCNData)
library(DRviaSPCNData)
a<-GetData("sdfSET")
